SELECT
  COUNT(*) FILTER (WHERE statut_calcule IN ('ouvert','en cours','cloture','ferme force')) AS of_lances,
	COUNT(*) FILTER (WHERE statut_calcule IN ('ouvert')) As of_ouvert,
  COUNT(*) FILTER (WHERE statut_calcule IN ('cloture','ferme force')) AS of_clotures,
	COUNT(*) FILTER (WHERE statut_calcule IN ('en cours')) AS of_encours,
  COALESCE(SUM(qte_lancee), 0) AS qte_lancee,
  COALESCE(SUM(qte_recue_pf), 0) AS qte_recue
FROM (
  SELECT
    id,
    qte_lancee,
    qte_recue_pf,
   CASE
  WHEN statut_force IS TRUE THEN 'ferme force'
  WHEN qte_recue_pf >= qte_lancee THEN 'cloture'
  WHEN qte_recue_pf > 0 THEN 'en cours'
  ELSE 'ouvert'
END AS statut_calcule


  FROM of_tracking
) t;
